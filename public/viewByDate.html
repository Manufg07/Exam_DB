<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bookings by Date</title>
    <!-- Include Tailwind CSS -->
    <link href="https://cdn.tailwindcss.com" rel="stylesheet">
</head>

<body class="bg-gray-100">
    <div class="max-w-3xl mx-auto py-8 px-4">
        <h1 class="text-3xl font-bold text-center mb-6">Bookings on <span id="dateDisplay"></span></h1>
        <div class="bg-white shadow-md rounded-lg overflow-hidden">
            <table class="min-w-full bg-white">
                <thead>
                    <tr class="bg-gray-200">
                        <th class="py-2 px-4">Room</th>
                        <th class="py-2 px-4">Name</th>
                        <th class="py-2 px-4">Check-In</th>
                        <th class="py-2 px-4">Check-Out</th>
                    </tr>
                </thead>
                <tbody id="bookingTable">
                    <!-- Booking details will be dynamically loaded here -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const urlParams = new URLSearchParams(window.location.search);
            const checkInDate = urlParams.get('date');

            if (!checkInDate) {
                console.error('Check-in date parameter missing');
                return;
            }

            try {
                const response = await fetch(`/view/${checkInDate}`);
                const bookings = await response.json();

                document.getElementById('dateDisplay').textContent = checkInDate; // Display the check-in date

                const bookingTable = document.getElementById('bookingTable');
                bookingTable.innerHTML = ''; // Clear any existing rows

                bookings.forEach(booking => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="py-2 px-4">${booking.room}</td>
                        <td class="py-2 px-4">${booking.name}</td>
                        <td class="py-2 px-4">${booking.checkIn}</td>
                        <td class="py-2 px-4">${booking.checkOut}</td>
                    `;
                    bookingTable.appendChild(row);
                });
            } catch (error) {
                console.error('Error fetching bookings:', error);
                const bookingTable = document.getElementById('bookingTable');
                bookingTable.innerHTML = '<tr><td colspan="4" class="py-2 px-4">Error fetching bookings</td></tr>';
            }
        });
    </script>
</body>

</html>
